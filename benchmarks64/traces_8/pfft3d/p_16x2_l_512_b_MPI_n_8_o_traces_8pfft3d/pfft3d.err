2024-03-19 02:49:10.317190: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -950.19GiB (-1020254117895 bytes) by rematerialization; only reduced to 7.25TiB (7971459301560 bytes), down from 7.25TiB (7971459301688 bytes) originally
2024-03-19 02:49:10.347533: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -950.19GiB (-1020254117895 bytes) by rematerialization; only reduced to 7.25TiB (7971459301560 bytes), down from 7.25TiB (7971459301688 bytes) originally
2024-03-19 02:49:10.348958: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -950.19GiB (-1020254117895 bytes) by rematerialization; only reduced to 7.25TiB (7971459301560 bytes), down from 7.25TiB (7971459301688 bytes) originally
2024-03-19 02:49:10.355268: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -950.19GiB (-1020254117895 bytes) by rematerialization; only reduced to 7.25TiB (7971459301560 bytes), down from 7.25TiB (7971459301688 bytes) originally
2024-03-19 02:49:10.345552: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -950.19GiB (-1020254117895 bytes) by rematerialization; only reduced to 7.25TiB (7971459301560 bytes), down from 7.25TiB (7971459301688 bytes) originally
2024-03-19 02:49:10.346036: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -950.19GiB (-1020254117895 bytes) by rematerialization; only reduced to 7.25TiB (7971459301560 bytes), down from 7.25TiB (7971459301688 bytes) originally
2024-03-19 02:49:10.346687: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -950.19GiB (-1020254117895 bytes) by rematerialization; only reduced to 7.25TiB (7971459301560 bytes), down from 7.25TiB (7971459301688 bytes) originally
2024-03-19 02:49:10.361413: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -950.19GiB (-1020254117895 bytes) by rematerialization; only reduced to 7.25TiB (7971459301560 bytes), down from 7.25TiB (7971459301688 bytes) originally
2024-03-19 02:49:10.366519: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -950.19GiB (-1020254117895 bytes) by rematerialization; only reduced to 7.25TiB (7971459301560 bytes), down from 7.25TiB (7971459301688 bytes) originally
2024-03-19 02:49:10.372902: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -950.19GiB (-1020254117895 bytes) by rematerialization; only reduced to 7.25TiB (7971459301560 bytes), down from 7.25TiB (7971459301688 bytes) originally
2024-03-19 02:49:10.374613: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -950.19GiB (-1020254117895 bytes) by rematerialization; only reduced to 7.25TiB (7971459301560 bytes), down from 7.25TiB (7971459301688 bytes) originally
2024-03-19 02:49:10.363687: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -950.19GiB (-1020254117895 bytes) by rematerialization; only reduced to 7.25TiB (7971459301560 bytes), down from 7.25TiB (7971459301688 bytes) originally
2024-03-19 02:49:10.367216: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -950.19GiB (-1020254117895 bytes) by rematerialization; only reduced to 7.25TiB (7971459301560 bytes), down from 7.25TiB (7971459301688 bytes) originally
2024-03-19 02:49:10.367813: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -950.19GiB (-1020254117895 bytes) by rematerialization; only reduced to 7.25TiB (7971459301560 bytes), down from 7.25TiB (7971459301688 bytes) originally
2024-03-19 02:49:10.349903: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -950.19GiB (-1020254117895 bytes) by rematerialization; only reduced to 7.25TiB (7971459301560 bytes), down from 7.25TiB (7971459301688 bytes) originally
2024-03-19 02:49:10.351665: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -950.19GiB (-1020254117895 bytes) by rematerialization; only reduced to 7.25TiB (7971459301560 bytes), down from 7.25TiB (7971459301688 bytes) originally
2024-03-19 02:49:10.354259: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -950.19GiB (-1020254117895 bytes) by rematerialization; only reduced to 7.25TiB (7971459301560 bytes), down from 7.25TiB (7971459301688 bytes) originally
2024-03-19 02:49:10.355871: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -950.19GiB (-1020254117895 bytes) by rematerialization; only reduced to 7.25TiB (7971459301560 bytes), down from 7.25TiB (7971459301688 bytes) originally
2024-03-19 02:49:10.356112: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -950.19GiB (-1020254117895 bytes) by rematerialization; only reduced to 7.25TiB (7971459301560 bytes), down from 7.25TiB (7971459301688 bytes) originally
2024-03-19 02:49:10.358129: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -950.19GiB (-1020254117895 bytes) by rematerialization; only reduced to 7.25TiB (7971459301560 bytes), down from 7.25TiB (7971459301688 bytes) originally
2024-03-19 02:49:10.361511: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -950.19GiB (-1020254117895 bytes) by rematerialization; only reduced to 7.25TiB (7971459301560 bytes), down from 7.25TiB (7971459301688 bytes) originally
2024-03-19 02:49:10.364244: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -950.19GiB (-1020254117895 bytes) by rematerialization; only reduced to 7.25TiB (7971459301560 bytes), down from 7.25TiB (7971459301688 bytes) originally
2024-03-19 02:49:10.364505: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -950.19GiB (-1020254117895 bytes) by rematerialization; only reduced to 7.25TiB (7971459301560 bytes), down from 7.25TiB (7971459301688 bytes) originally
2024-03-19 02:49:10.367094: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -950.19GiB (-1020254117895 bytes) by rematerialization; only reduced to 7.25TiB (7971459301560 bytes), down from 7.25TiB (7971459301688 bytes) originally
2024-03-19 02:49:10.367336: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -950.19GiB (-1020254117895 bytes) by rematerialization; only reduced to 7.25TiB (7971459301560 bytes), down from 7.25TiB (7971459301688 bytes) originally
2024-03-19 02:49:10.367642: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -950.19GiB (-1020254117895 bytes) by rematerialization; only reduced to 7.25TiB (7971459301560 bytes), down from 7.25TiB (7971459301688 bytes) originally
2024-03-19 02:49:10.372905: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -950.19GiB (-1020254117895 bytes) by rematerialization; only reduced to 7.25TiB (7971459301560 bytes), down from 7.25TiB (7971459301688 bytes) originally
2024-03-19 02:49:10.374371: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -950.19GiB (-1020254117895 bytes) by rematerialization; only reduced to 7.25TiB (7971459301560 bytes), down from 7.25TiB (7971459301688 bytes) originally
2024-03-19 02:49:10.377860: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -950.19GiB (-1020254117895 bytes) by rematerialization; only reduced to 7.25TiB (7971459301560 bytes), down from 7.25TiB (7971459301688 bytes) originally
2024-03-19 02:49:10.374907: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -950.19GiB (-1020254117895 bytes) by rematerialization; only reduced to 7.25TiB (7971459301560 bytes), down from 7.25TiB (7971459301688 bytes) originally
2024-03-19 02:49:10.376032: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -950.19GiB (-1020254117895 bytes) by rematerialization; only reduced to 7.25TiB (7971459301560 bytes), down from 7.25TiB (7971459301688 bytes) originally
2024-03-19 02:49:10.377867: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -950.19GiB (-1020254117895 bytes) by rematerialization; only reduced to 7.25TiB (7971459301560 bytes), down from 7.25TiB (7971459301688 bytes) originally
2024-03-19 02:49:20.564750: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_2_bfc) ran out of memory trying to allocate 1.00TiB (rounded to 1099511627776)requested by op 
2024-03-19 02:49:20.564961: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
E0319 02:49:20.565129  243562 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


2024-03-19 02:49:20.590531: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_0_bfc) ran out of memory trying to allocate 1.00TiB (rounded to 1099511627776)requested by op 
2024-03-19 02:49:20.590743: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
2024-03-19 02:49:20.590750: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_1_bfc) ran out of memory trying to allocate 1.00TiB (rounded to 1099511627776)requested by op 
2024-03-19 02:49:20.590952: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
E0319 02:49:20.590993  243560 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


E0319 02:49:20.591151  243561 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


2024-03-19 02:49:20.594753: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_3_bfc) ran out of memory trying to allocate 1.00TiB (rounded to 1099511627776)requested by op 
2024-03-19 02:49:20.594956: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
E0319 02:49:20.595204  243563 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


2024-03-19 02:49:20.596976: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_2_bfc) ran out of memory trying to allocate 1.00TiB (rounded to 1099511627776)requested by op 
2024-03-19 02:49:20.597186: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
E0319 02:49:20.597367  458228 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


2024-03-19 02:49:20.599150: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_0_bfc) ran out of memory trying to allocate 1.00TiB (rounded to 1099511627776)requested by op 
2024-03-19 02:49:20.599099: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_1_bfc) ran out of memory trying to allocate 1.00TiB (rounded to 1099511627776)requested by op 
2024-03-19 02:49:20.599307: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
2024-03-19 02:49:20.599326: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
E0319 02:49:20.599467 1491821 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

E0319 02:49:20.599452 1491822 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


2024-03-19 02:49:20.599984: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_3_bfc) ran out of memory trying to allocate 1.00TiB (rounded to 1099511627776)requested by op 
2024-03-19 02:49:20.600104: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
E0319 02:49:20.600271 1491824 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


2024-03-19 02:49:20.603621: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_2_bfc) ran out of memory trying to allocate 1.00TiB (rounded to 1099511627776)requested by op 
2024-03-19 02:49:20.603720: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
E0319 02:49:20.603875 1491823 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
2024-03-19 02:49:20.608547: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_1_bfc) ran out of memory trying to allocate 1.00TiB (rounded to 1099511627776)requested by op 
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
2024-03-19 02:49:20.608758: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


E0319 02:49:20.609023 1837865 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


2024-03-19 02:49:20.612227: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_3_bfc) ran out of memory trying to allocate 1.00TiB (rounded to 1099511627776)requested by op 
2024-03-19 02:49:20.612451: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
E0319 02:49:20.612701  458229 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
2024-03-19 02:49:20.614138: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_0_bfc) ran out of memory trying to allocate 1.00TiB (rounded to 1099511627776)requested by op 
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
2024-03-19 02:49:20.614236: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
E0319 02:49:20.614388 1837864 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


2024-03-19 02:49:20.615006: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_2_bfc) ran out of memory trying to allocate 1.00TiB (rounded to 1099511627776)requested by op 
2024-03-19 02:49:20.615123: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
2024-03-19 02:49:20.615140: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_3_bfc) ran out of memory trying to allocate 1.00TiB (rounded to 1099511627776)requested by op 
2024-03-19 02:49:20.615238: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
E0319 02:49:20.615282 1837866 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


E0319 02:49:20.615385 1837867 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


2024-03-19 02:49:20.616344: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_3_bfc) ran out of memory trying to allocate 1.00TiB (rounded to 1099511627776)requested by op 
2024-03-19 02:49:20.616551: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
E0319 02:49:20.616821 1921531 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
2024-03-19 02:49:20.620872: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_0_bfc) ran out of memory trying to allocate 1.00TiB (rounded to 1099511627776)requested by op 
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
2024-03-19 02:49:20.620859: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_1_bfc) ran out of memory trying to allocate 1.00TiB (rounded to 1099511627776)requested by op 
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
2024-03-19 02:49:20.621021: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


2024-03-19 02:49:20.621021: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
2024-03-19 02:49:20.621028: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_3_bfc) ran out of memory trying to allocate 1.00TiB (rounded to 1099511627776)requested by op 
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
E0319 02:49:20.621184 3650440 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
E0319 02:49:20.621184 3650439 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
2024-03-19 02:49:20.621224: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


E0319 02:49:20.621472 3650442 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
2024-03-19 02:49:20.622908: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_2_bfc) ran out of memory trying to allocate 1.00TiB (rounded to 1099511627776)requested by op 
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
2024-03-19 02:49:20.623005: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


E0319 02:49:20.623147 3650441 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


2024-03-19 02:49:20.623998: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_1_bfc) ran out of memory trying to allocate 1.00TiB (rounded to 1099511627776)requested by op 
2024-03-19 02:49:20.624208: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
E0319 02:49:20.624483  458227 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
2024-03-19 02:49:20.624790: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_2_bfc) ran out of memory trying to allocate 1.00TiB (rounded to 1099511627776)requested by op 
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

2024-03-19 02:49:20.624881: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


E0319 02:49:20.625011 1921530 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


2024-03-19 02:49:20.627879: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_0_bfc) ran out of memory trying to allocate 1.00TiB (rounded to 1099511627776)requested by op 
jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
2024-03-19 02:49:20.627970: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
E0319 02:49:20.628107  458226 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


2024-03-19 02:49:20.629254: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_1_bfc) ran out of memory trying to allocate 1.00TiB (rounded to 1099511627776)requested by op 
2024-03-19 02:49:20.629459: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
2024-03-19 02:49:20.629632: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_0_bfc) ran out of memory trying to allocate 1.00TiB (rounded to 1099511627776)requested by op 
E0319 02:49:20.629713 1921529 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

2024-03-19 02:49:20.629851: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


E0319 02:49:20.630032 1921528 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


2024-03-19 02:49:20.636399: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_3_bfc) ran out of memory trying to allocate 1.00TiB (rounded to 1099511627776)requested by op 
2024-03-19 02:49:20.636625: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
E0319 02:49:20.636862 2519756 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
2024-03-19 02:49:20.637218: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_2_bfc) ran out of memory trying to allocate 1.00TiB (rounded to 1099511627776)requested by op 
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
2024-03-19 02:49:20.637269: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_0_bfc) ran out of memory trying to allocate 1.00TiB (rounded to 1099511627776)requested by op 
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
2024-03-19 02:49:20.637313: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
2024-03-19 02:49:20.637373: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
E0319 02:49:20.637459 2519755 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
E0319 02:49:20.637541 2519753 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


2024-03-19 02:49:20.637705: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_1_bfc) ran out of memory trying to allocate 1.00TiB (rounded to 1099511627776)requested by op 
2024-03-19 02:49:20.637795: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
E0319 02:49:20.637944 2519754 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


2024-03-19 02:49:20.639909: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_0_bfc) ran out of memory trying to allocate 1.00TiB (rounded to 1099511627776)requested by op 
2024-03-19 02:49:20.640126: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
E0319 02:49:20.640415 3032935 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
2024-03-19 02:49:20.640880: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_2_bfc) ran out of memory trying to allocate 1.00TiB (rounded to 1099511627776)requested by op 
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
2024-03-19 02:49:20.640921: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_3_bfc) ran out of memory trying to allocate 1.00TiB (rounded to 1099511627776)requested by op 
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
2024-03-19 02:49:20.641093: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


2024-03-19 02:49:20.641144: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
E0319 02:49:20.641267 3032937 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


E0319 02:49:20.641287 3032938 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

2024-03-19 02:49:20.641417: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_1_bfc) ran out of memory trying to allocate 1.00TiB (rounded to 1099511627776)requested by op 
	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


2024-03-19 02:49:20.641525: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
E0319 02:49:20.641713 3032936 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 1099511627776 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    1.00TiB
     preallocated temp allocation:    5.25TiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:    6.25TiB
              total fragmentation:     1.2KiB (0.00%)
Peak buffers:
	Buffer 1:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[137438953472]
		==========================

	Buffer 2:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 3:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 4:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 5:
		Size: 1.00TiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f64[1024,8192,16384]
		==========================

	Buffer 6:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 7:
		Size: 512.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[64,2147483648]
		==========================

	Buffer 8:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 9:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: pred[1024,8192,16384]
		==========================

	Buffer 10:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


		==========================

	Buffer 11:
		Size: 128B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[32]
		==========================

	Buffer 12:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (f64[1024,8192,16384], f64[1024,8192,16384], f64[1024,8192,16384], pred[1024,8192,16384], pred[1024,8192,16384], /*index=5*/f64[1024,8192,16384], f64[137438953472])
		==========================

	Buffer 13:
		Size: 32B
		XLA Label: tuple
		Shape: (u32[64,2147483648], u32[64,2147483648], u32[64,2147483648], u32[64,2147483648])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0, 1) limit_indices=(64, 2) strides=(1, 1)]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[64,1], u32[64,1])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[64,2147483648], u32[64,2147483648])
		==========================


srun: error: r8i6n7: tasks 16-17,19: Exited with exit code 1
srun: Terminating StepId=1139838.31
srun: error: r8i7n0: tasks 24-27: Exited with exit code 1
srun: error: r6i6n3: tasks 0-3: Exited with exit code 1
srun: error: r6i6n5: tasks 8-11: Exited with exit code 1
srun: error: r6i6n4: tasks 4-7: Exited with exit code 1
srun: error: r8i6n6: tasks 12-15: Exited with exit code 1
srun: error: r8i6n8: tasks 20-23: Exited with exit code 1
srun: error: r8i7n1: tasks 28-31: Exited with exit code 1
srun: error: r8i6n7: task 18: Exited with exit code 1
