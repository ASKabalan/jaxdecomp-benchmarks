2024-03-17 17:41:53.077301: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below 15.01GiB (16121490629 bytes) by rematerialization; only reduced to 58.00GiB (62277025816 bytes), down from 58.00GiB (62277025848 bytes) originally
2024-03-17 17:41:53.117079: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below 15.01GiB (16121490629 bytes) by rematerialization; only reduced to 58.00GiB (62277025816 bytes), down from 58.00GiB (62277025848 bytes) originally
2024-03-17 17:41:53.078039: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below 15.01GiB (16121490629 bytes) by rematerialization; only reduced to 58.00GiB (62277025816 bytes), down from 58.00GiB (62277025848 bytes) originally
2024-03-17 17:41:53.117763: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below 15.01GiB (16121490629 bytes) by rematerialization; only reduced to 58.00GiB (62277025816 bytes), down from 58.00GiB (62277025848 bytes) originally
2024-03-17 17:41:53.119826: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below 15.01GiB (16121490629 bytes) by rematerialization; only reduced to 58.00GiB (62277025816 bytes), down from 58.00GiB (62277025848 bytes) originally
2024-03-17 17:41:53.120222: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below 15.01GiB (16121490629 bytes) by rematerialization; only reduced to 58.00GiB (62277025816 bytes), down from 58.00GiB (62277025848 bytes) originally
2024-03-17 17:41:53.380599: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below 15.01GiB (16121490629 bytes) by rematerialization; only reduced to 58.00GiB (62277025816 bytes), down from 58.00GiB (62277025848 bytes) originally
2024-03-17 17:41:53.383154: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below 15.01GiB (16121490629 bytes) by rematerialization; only reduced to 58.00GiB (62277025816 bytes), down from 58.00GiB (62277025848 bytes) originally
2024-03-17 17:42:03.266389: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_3_bfc) ran out of memory trying to allocate 42.00GiB (rounded to 45097157120)requested by op 
2024-03-17 17:42:03.266615: W external/tsl/tsl/framework/bfc_allocator.cc:494] **********************************__________________________________________________________________
E0317 17:42:03.266789 3238695 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 45097156992 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   42.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   50.00GiB
              total fragmentation:       328B (0.00%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[1073741824]
		==========================

	Buffer 2:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 3:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 4:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 5:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 8:
		Size: 1.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: pred[256,2048,2048]
		==========================

	Buffer 9:
		Size: 1.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: pred[256,2048,2048]
		==========================

	Buffer 10:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: (f64[256,2048,2048], f64[256,2048,2048], f64[256,2048,2048], pred[256,2048,2048], pred[256,2048,2048], /*index=5*/f64[256,2048,2048], f64[1073741824])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 13:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


2024-03-17 17:42:03.267160: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_0_bfc) ran out of memory trying to allocate 42.00GiB (rounded to 45097157120)requested by op 
2024-03-17 17:42:03.267269: W external/tsl/tsl/framework/bfc_allocator.cc:494] **********************************__________________________________________________________________
E0317 17:42:03.267417 3238692 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 45097156992 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   42.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   50.00GiB
              total fragmentation:       328B (0.00%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[1073741824]
		==========================

	Buffer 2:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 3:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 4:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 5:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 8:
		Size: 1.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: pred[256,2048,2048]
		==========================

	Buffer 9:
		Size: 1.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: pred[256,2048,2048]
		==========================

	Buffer 10:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: (f64[256,2048,2048], f64[256,2048,2048], f64[256,2048,2048], pred[256,2048,2048], pred[256,2048,2048], /*index=5*/f64[256,2048,2048], f64[1073741824])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 13:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py", line 110, in <module>
    run_benchmark(global_shape,nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py", line 25, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 45097156992 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   42.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   50.00GiB
              total fragmentation:       328B (0.00%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[1073741824]
		==========================

	Buffer 2:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 3:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 4:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 5:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 8:
		Size: 1.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: pred[256,2048,2048]
		==========================

	Buffer 9:
		Size: 1.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: pred[256,2048,2048]
		==========================

	Buffer 10:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: (f64[256,2048,2048], f64[256,2048,2048], f64[256,2048,2048], pred[256,2048,2048], pred[256,2048,2048], /*index=5*/f64[256,2048,2048], f64[1073741824])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 13:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py", line 110, in <module>
    run_benchmark(global_shape,nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py", line 25, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 45097156992 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   42.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   50.00GiB
              total fragmentation:       328B (0.00%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[1073741824]
		==========================

	Buffer 2:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 3:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 4:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 5:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 8:
		Size: 1.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: pred[256,2048,2048]
		==========================

	Buffer 9:
		Size: 1.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: pred[256,2048,2048]
		==========================

	Buffer 10:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: (f64[256,2048,2048], f64[256,2048,2048], f64[256,2048,2048], pred[256,2048,2048], pred[256,2048,2048], /*index=5*/f64[256,2048,2048], f64[1073741824])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 13:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


2024-03-17 17:42:03.309636: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_1_bfc) ran out of memory trying to allocate 42.00GiB (rounded to 45097157120)requested by op 
2024-03-17 17:42:03.309956: W external/tsl/tsl/framework/bfc_allocator.cc:494] **********************************__________________________________________________________________
E0317 17:42:03.310172 3914884 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 45097156992 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   42.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   50.00GiB
              total fragmentation:       328B (0.00%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[1073741824]
		==========================

	Buffer 2:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 3:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 4:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 5:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 8:
		Size: 1.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: pred[256,2048,2048]
		==========================

	Buffer 9:
		Size: 1.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: pred[256,2048,2048]
		==========================

	Buffer 10:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: (f64[256,2048,2048], f64[256,2048,2048], f64[256,2048,2048], pred[256,2048,2048], pred[256,2048,2048], /*index=5*/f64[256,2048,2048], f64[1073741824])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 13:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


2024-03-17 17:42:03.310744: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_0_bfc) ran out of memory trying to allocate 42.00GiB (rounded to 45097157120)requested by op 
2024-03-17 17:42:03.310844: W external/tsl/tsl/framework/bfc_allocator.cc:494] **********************************__________________________________________________________________
E0317 17:42:03.310976 3914883 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 45097156992 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   42.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   50.00GiB
              total fragmentation:       328B (0.00%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[1073741824]
		==========================

	Buffer 2:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 3:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 4:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 5:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 8:
		Size: 1.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: pred[256,2048,2048]
		==========================

	Buffer 9:
		Size: 1.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: pred[256,2048,2048]
		==========================

	Buffer 10:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: (f64[256,2048,2048], f64[256,2048,2048], f64[256,2048,2048], pred[256,2048,2048], pred[256,2048,2048], /*index=5*/f64[256,2048,2048], f64[1073741824])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 13:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


2024-03-17 17:42:03.311769: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_2_bfc) ran out of memory trying to allocate 42.00GiB (rounded to 45097157120)requested by op 
2024-03-17 17:42:03.311789: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_3_bfc) ran out of memory trying to allocate 42.00GiB (rounded to 45097157120)requested by op 
2024-03-17 17:42:03.311941: W external/tsl/tsl/framework/bfc_allocator.cc:494] **********************************__________________________________________________________________
2024-03-17 17:42:03.311956: W external/tsl/tsl/framework/bfc_allocator.cc:494] **********************************__________________________________________________________________
E0317 17:42:03.312062 3914885 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 45097156992 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   42.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   50.00GiB
              total fragmentation:       328B (0.00%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[1073741824]
		==========================

	Buffer 2:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 3:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 4:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 5:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 8:
		Size: 1.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: pred[256,2048,2048]
		==========================

	Buffer 9:
		Size: 1.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: pred[256,2048,2048]
		==========================

	Buffer 10:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: (f64[256,2048,2048], f64[256,2048,2048], f64[256,2048,2048], pred[256,2048,2048], pred[256,2048,2048], /*index=5*/f64[256,2048,2048], f64[1073741824])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 13:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


E0317 17:42:03.312082 3914886 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 45097156992 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   42.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   50.00GiB
              total fragmentation:       328B (0.00%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[1073741824]
		==========================

	Buffer 2:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 3:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 4:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 5:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 8:
		Size: 1.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: pred[256,2048,2048]
		==========================

	Buffer 9:
		Size: 1.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: pred[256,2048,2048]
		==========================

	Buffer 10:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: (f64[256,2048,2048], f64[256,2048,2048], f64[256,2048,2048], pred[256,2048,2048], pred[256,2048,2048], /*index=5*/f64[256,2048,2048], f64[1073741824])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 13:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py", line 110, in <module>
    run_benchmark(global_shape,nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py", line 25, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 45097156992 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   42.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   50.00GiB
              total fragmentation:       328B (0.00%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[1073741824]
		==========================

	Buffer 2:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 3:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 4:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 5:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 8:
		Size: 1.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: pred[256,2048,2048]
		==========================

	Buffer 9:
		Size: 1.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: pred[256,2048,2048]
		==========================

	Buffer 10:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: (f64[256,2048,2048], f64[256,2048,2048], f64[256,2048,2048], pred[256,2048,2048], pred[256,2048,2048], /*index=5*/f64[256,2048,2048], f64[1073741824])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 13:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py", line 110, in <module>
    run_benchmark(global_shape,nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py", line 25, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 45097156992 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   42.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   50.00GiB
              total fragmentation:       328B (0.00%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[1073741824]
		==========================

	Buffer 2:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 3:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 4:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 5:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 8:
		Size: 1.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: pred[256,2048,2048]
		==========================

	Buffer 9:
		Size: 1.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: pred[256,2048,2048]
		==========================

	Buffer 10:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: (f64[256,2048,2048], f64[256,2048,2048], f64[256,2048,2048], pred[256,2048,2048], pred[256,2048,2048], /*index=5*/f64[256,2048,2048], f64[1073741824])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 13:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py", line 110, in <module>
    run_benchmark(global_shape,nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py", line 25, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 45097156992 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   42.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   50.00GiB
              total fragmentation:       328B (0.00%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[1073741824]
		==========================

	Buffer 2:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 3:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 4:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 5:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 8:
		Size: 1.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: pred[256,2048,2048]
		==========================

	Buffer 9:
		Size: 1.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: pred[256,2048,2048]
		==========================

	Buffer 10:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py", line 110, in <module>
    run_benchmark(global_shape,nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py", line 25, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 45097156992 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   42.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   50.00GiB
              total fragmentation:       328B (0.00%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[1073741824]
		==========================

	Buffer 2:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 3:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 4:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 5:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 8:
		Size: 1.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: pred[256,2048,2048]
		==========================

	Buffer 9:
		Size: 1.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: pred[256,2048,2048]
		==========================

	Buffer 10:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: (f64[256,2048,2048], f64[256,2048,2048], f64[256,2048,2048], pred[256,2048,2048], pred[256,2048,2048], /*index=5*/f64[256,2048,2048], f64[1073741824])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 13:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


		Shape: (f64[256,2048,2048], f64[256,2048,2048], f64[256,2048,2048], pred[256,2048,2048], pred[256,2048,2048], /*index=5*/f64[256,2048,2048], f64[1073741824])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 13:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


2024-03-17 17:42:03.569438: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_2_bfc) ran out of memory trying to allocate 42.00GiB (rounded to 45097157120)requested by op 
2024-03-17 17:42:03.569654: W external/tsl/tsl/framework/bfc_allocator.cc:494] **********************************__________________________________________________________________
2024-03-17 17:42:03.569770: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_1_bfc) ran out of memory trying to allocate 42.00GiB (rounded to 45097157120)requested by op 
E0317 17:42:03.569855 3238694 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 45097156992 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   42.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   50.00GiB
              total fragmentation:       328B (0.00%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[1073741824]
		==========================

	Buffer 2:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 3:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 4:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 5:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 8:
		Size: 1.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: pred[256,2048,2048]
		==========================

	Buffer 9:
		Size: 1.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: pred[256,2048,2048]
		==========================

	Buffer 10:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: (f64[256,2048,2048], f64[256,2048,2048], f64[256,2048,2048], pred[256,2048,2048], pred[256,2048,2048], /*index=5*/f64[256,2048,2048], f64[1073741824])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

2024-03-17 17:42:03.569981: W external/tsl/tsl/framework/bfc_allocator.cc:494] **********************************__________________________________________________________________
E0317 17:42:03.570173 3238693 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 45097156992 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   42.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   50.00GiB
              total fragmentation:       328B (0.00%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[1073741824]
		==========================

	Buffer 2:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 3:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 4:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 5:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 8:
		Size: 1.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: pred[256,2048,2048]
		==========================

	Buffer 9:
		Size: 1.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: pred[256,2048,2048]
		==========================

	Buffer 10:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: (f64[256,2048,2048], f64[256,2048,2048], f64[256,2048,2048], pred[256,2048,2048], pred[256,2048,2048], /*index=5*/f64[256,2048,2048], f64[1073741824])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 12:
		Size: 16B
	Buffer 13:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 13:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py", line 110, in <module>
    run_benchmark(global_shape,nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py", line 25, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 45097156992 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   42.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   50.00GiB
              total fragmentation:       328B (0.00%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[1073741824]
		==========================

	Buffer 2:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 3:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 4:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 5:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 8:
		Size: 1.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: pred[256,2048,2048]
		==========================

	Buffer 9:
		Size: 1.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: pred[256,2048,2048]
		==========================

	Buffer 10:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: (f64[256,2048,2048], f64[256,2048,2048], f64[256,2048,2048], pred[256,2048,2048], pred[256,2048,2048], /*index=5*/f64[256,2048,2048], f64[1073741824])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 13:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py", line 110, in <module>
    run_benchmark(global_shape,nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py", line 25, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 45097156992 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   42.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   50.00GiB
              total fragmentation:       328B (0.00%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[1073741824]
		==========================

	Buffer 2:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 3:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 4:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 5:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: f64[256,2048,2048]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 8:
		Size: 1.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: pred[256,2048,2048]
		==========================

	Buffer 9:
		Size: 1.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: pred[256,2048,2048]
		==========================

	Buffer 10:
		Size: 56B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/erf_inv" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: (f64[256,2048,2048], f64[256,2048,2048], f64[256,2048,2048], pred[256,2048,2048], pred[256,2048,2048], /*index=5*/f64[256,2048,2048], f64[1073741824])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=25
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 13:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


srun: error: r6i6n8: tasks 0-2: Exited with exit code 1
srun: Terminating StepId=1125460.68
slurmstepd: error: *** STEP 1125460.68 ON r6i6n8 CANCELLED AT 2024-03-17T17:42:04 ***
srun: error: r6i6n8: task 3: Exited with exit code 1
srun: error: r6i7n1: tasks 4-7: Exited with exit code 1
