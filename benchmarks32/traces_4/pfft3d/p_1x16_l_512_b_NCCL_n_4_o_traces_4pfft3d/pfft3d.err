2024-03-17 16:38:14.616692: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -98.99GiB (-106285077306 bytes) by rematerialization; only reduced to 512.00GiB (549755813776 bytes), down from 512.00GiB (549755813936 bytes) originally
2024-03-17 16:38:14.630022: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -98.99GiB (-106285077306 bytes) by rematerialization; only reduced to 512.00GiB (549755813776 bytes), down from 512.00GiB (549755813936 bytes) originally
2024-03-17 16:38:14.649795: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -98.99GiB (-106285077306 bytes) by rematerialization; only reduced to 512.00GiB (549755813776 bytes), down from 512.00GiB (549755813936 bytes) originally
2024-03-17 16:38:14.630418: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -98.99GiB (-106285077306 bytes) by rematerialization; only reduced to 512.00GiB (549755813776 bytes), down from 512.00GiB (549755813936 bytes) originally
2024-03-17 16:38:14.643172: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -98.99GiB (-106285077306 bytes) by rematerialization; only reduced to 512.00GiB (549755813776 bytes), down from 512.00GiB (549755813936 bytes) originally
2024-03-17 16:38:14.645024: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -98.99GiB (-106285077306 bytes) by rematerialization; only reduced to 512.00GiB (549755813776 bytes), down from 512.00GiB (549755813936 bytes) originally
2024-03-17 16:38:14.630280: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -98.99GiB (-106285077306 bytes) by rematerialization; only reduced to 512.00GiB (549755813776 bytes), down from 512.00GiB (549755813936 bytes) originally
2024-03-17 16:38:14.650486: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -98.99GiB (-106285077306 bytes) by rematerialization; only reduced to 512.00GiB (549755813776 bytes), down from 512.00GiB (549755813936 bytes) originally
2024-03-17 16:38:14.650487: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -98.99GiB (-106285077306 bytes) by rematerialization; only reduced to 512.00GiB (549755813776 bytes), down from 512.00GiB (549755813936 bytes) originally
2024-03-17 16:38:14.672739: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -98.99GiB (-106285077306 bytes) by rematerialization; only reduced to 512.00GiB (549755813776 bytes), down from 512.00GiB (549755813936 bytes) originally
2024-03-17 16:38:14.649965: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -98.99GiB (-106285077306 bytes) by rematerialization; only reduced to 512.00GiB (549755813776 bytes), down from 512.00GiB (549755813936 bytes) originally
2024-03-17 16:38:14.650853: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -98.99GiB (-106285077306 bytes) by rematerialization; only reduced to 512.00GiB (549755813776 bytes), down from 512.00GiB (549755813936 bytes) originally
2024-03-17 16:38:14.651856: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -98.99GiB (-106285077306 bytes) by rematerialization; only reduced to 512.00GiB (549755813776 bytes), down from 512.00GiB (549755813936 bytes) originally
2024-03-17 16:38:14.672981: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -98.99GiB (-106285077306 bytes) by rematerialization; only reduced to 512.00GiB (549755813776 bytes), down from 512.00GiB (549755813936 bytes) originally
2024-03-17 16:38:14.674381: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -98.99GiB (-106285077306 bytes) by rematerialization; only reduced to 512.00GiB (549755813776 bytes), down from 512.00GiB (549755813936 bytes) originally
2024-03-17 16:38:14.674444: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -98.99GiB (-106285077306 bytes) by rematerialization; only reduced to 512.00GiB (549755813776 bytes), down from 512.00GiB (549755813936 bytes) originally
2024-03-17 16:38:24.733618: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_0_bfc) ran out of memory trying to allocate 128.00GiB (rounded to 137438953472)requested by op 
2024-03-17 16:38:24.733822: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
E0317 16:38:24.734035 3016085 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: f32[8192,512,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


2024-03-17 16:38:24.742051: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_1_bfc) ran out of memory trying to allocate 128.00GiB (rounded to 137438953472)requested by op 
2024-03-17 16:38:24.742146: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
E0317 16:38:24.742259 3016086 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: f32[8192,512,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 168, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 32, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: f32[8192,512,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


2024-03-17 16:38:24.747063: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_2_bfc) ran out of memory trying to allocate 128.00GiB (rounded to 137438953472)requested by op 
2024-03-17 16:38:24.747172: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
E0317 16:38:24.747303 2077584 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: f32[8192,512,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


2024-03-17 16:38:24.747366: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_3_bfc) ran out of memory trying to allocate 128.00GiB (rounded to 137438953472)requested by op 
2024-03-17 16:38:24.747458: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
E0317 16:38:24.747579 2077585 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: f32[8192,512,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 168, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 32, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: f32[8192,512,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


2024-03-17 16:38:24.760657: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_2_bfc) ran out of memory trying to allocate 128.00GiB (rounded to 137438953472)requested by op 
2024-03-17 16:38:24.760652: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_3_bfc) ran out of memory trying to allocate 128.00GiB (rounded to 137438953472)requested by op 
2024-03-17 16:38:24.760849: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
2024-03-17 16:38:24.760851: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
E0317 16:38:24.760984 3016087 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: f32[8192,512,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 168, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 32, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: f32[8192,512,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
E0317 16:38:24.760982 3016088 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: f32[8192,512,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 168, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 32, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: f32[8192,512,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


2024-03-17 16:38:24.769277: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_1_bfc) ran out of memory trying to allocate 128.00GiB (rounded to 137438953472)requested by op 
2024-03-17 16:38:24.769453: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
E0317 16:38:24.769569 2431361 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: f32[8192,512,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


2024-03-17 16:38:24.771606: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_0_bfc) ran out of memory trying to allocate 128.00GiB (rounded to 137438953472)requested by op 
2024-03-17 16:38:24.771697: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
E0317 16:38:24.771812 2431360 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: f32[8192,512,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


2024-03-17 16:38:24.772366: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_1_bfc) ran out of memory trying to allocate 128.00GiB (rounded to 137438953472)requested by op 
2024-03-17 16:38:24.772570: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
2024-03-17 16:38:24.772680: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_0_bfc) ran out of memory trying to allocate 128.00GiB (rounded to 137438953472)requested by op 
E0317 16:38:24.772777 2077583 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: f32[8192,512,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
2024-03-17 16:38:24.772815: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


E0317 16:38:24.772935 2077582 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: f32[8192,512,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


2024-03-17 16:38:24.773569: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_3_bfc) ran out of memory trying to allocate 128.00GiB (rounded to 137438953472)requested by op 
2024-03-17 16:38:24.773776: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
E0317 16:38:24.773987 2431363 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: f32[8192,512,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


2024-03-17 16:38:24.774732: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_2_bfc) ran out of memory trying to allocate 128.00GiB (rounded to 137438953472)requested by op 
2024-03-17 16:38:24.774827: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
E0317 16:38:24.774952 2431362 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: f32[8192,512,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 168, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 32, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: f32[8192,512,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 168, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 32, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: f32[8192,512,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 168, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 32, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: f32[8192,512,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 168, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 32, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: f32[8192,512,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 168, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 32, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: f32[8192,512,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 168, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 32, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: f32[8192,512,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 168, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 32, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: f32[8192,512,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 168, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 32, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: f32[8192,512,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


2024-03-17 16:38:24.800766: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_0_bfc) ran out of memory trying to allocate 128.00GiB (rounded to 137438953472)requested by op 
2024-03-17 16:38:24.800965: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
2024-03-17 16:38:24.801073: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_1_bfc) ran out of memory trying to allocate 128.00GiB (rounded to 137438953472)requested by op 
E0317 16:38:24.801203 1149503 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: f32[8192,512,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


2024-03-17 16:38:24.801244: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
E0317 16:38:24.801362 1149504 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: f32[8192,512,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


2024-03-17 16:38:24.802719: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_3_bfc) ran out of memory trying to allocate 128.00GiB (rounded to 137438953472)requested by op 
2024-03-17 16:38:24.802886: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_2_bfc) ran out of memory trying to allocate 128.00GiB (rounded to 137438953472)requested by op 
2024-03-17 16:38:24.802917: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
2024-03-17 16:38:24.803092: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
E0317 16:38:24.803141 1149506 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: f32[8192,512,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
E0317 16:38:24.803305 1149505 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: f32[8192,512,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 168, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 32, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: f32[8192,512,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 168, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 32, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: f32[8192,512,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 168, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 32, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: f32[8192,512,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 168, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 32, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: f32[8192,512,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=32
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


srun: error: r7i2n6: tasks 1-3: Exited with exit code 1
srun: Terminating StepId=1124850.6
srun: error: r9i0n3: tasks 12-13,15: Exited with exit code 1
srun: error: r8i5n6: tasks 8,10-11: Exited with exit code 1
srun: error: r7i7n3: tasks 4,6-7: Exited with exit code 1
srun: error: r7i2n6: task 0: Exited with exit code 1
srun: error: r7i7n3: task 5: Exited with exit code 1
srun: error: r9i0n3: task 14: Exited with exit code 1
srun: error: r8i5n6: task 9: Exited with exit code 1
