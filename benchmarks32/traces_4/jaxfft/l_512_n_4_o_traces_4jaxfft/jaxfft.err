2024-03-17 17:19:12.887055: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -98.99GiB (-106285077306 bytes) by rematerialization; only reduced to 512.00GiB (549755813776 bytes), down from 512.00GiB (549755813936 bytes) originally
2024-03-17 17:19:12.887112: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -98.99GiB (-106285077306 bytes) by rematerialization; only reduced to 512.00GiB (549755813776 bytes), down from 512.00GiB (549755813936 bytes) originally
2024-03-17 17:19:12.891039: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -98.99GiB (-106285077306 bytes) by rematerialization; only reduced to 512.00GiB (549755813776 bytes), down from 512.00GiB (549755813936 bytes) originally
2024-03-17 17:19:12.919397: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -98.99GiB (-106285077306 bytes) by rematerialization; only reduced to 512.00GiB (549755813776 bytes), down from 512.00GiB (549755813936 bytes) originally
2024-03-17 17:19:12.909577: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -98.99GiB (-106285077306 bytes) by rematerialization; only reduced to 512.00GiB (549755813776 bytes), down from 512.00GiB (549755813936 bytes) originally
2024-03-17 17:19:12.912684: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -98.99GiB (-106285077306 bytes) by rematerialization; only reduced to 512.00GiB (549755813776 bytes), down from 512.00GiB (549755813936 bytes) originally
2024-03-17 17:19:12.913178: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -98.99GiB (-106285077306 bytes) by rematerialization; only reduced to 512.00GiB (549755813776 bytes), down from 512.00GiB (549755813936 bytes) originally
2024-03-17 17:19:12.889129: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -98.99GiB (-106285077306 bytes) by rematerialization; only reduced to 512.00GiB (549755813776 bytes), down from 512.00GiB (549755813936 bytes) originally
2024-03-17 17:19:12.899384: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -98.99GiB (-106285077306 bytes) by rematerialization; only reduced to 512.00GiB (549755813776 bytes), down from 512.00GiB (549755813936 bytes) originally
2024-03-17 17:19:12.899653: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -98.99GiB (-106285077306 bytes) by rematerialization; only reduced to 512.00GiB (549755813776 bytes), down from 512.00GiB (549755813936 bytes) originally
2024-03-17 17:19:12.906269: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -98.99GiB (-106285077306 bytes) by rematerialization; only reduced to 512.00GiB (549755813776 bytes), down from 512.00GiB (549755813936 bytes) originally
2024-03-17 17:19:12.910104: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -98.99GiB (-106285077306 bytes) by rematerialization; only reduced to 512.00GiB (549755813776 bytes), down from 512.00GiB (549755813936 bytes) originally
2024-03-17 17:19:12.910385: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -98.99GiB (-106285077306 bytes) by rematerialization; only reduced to 512.00GiB (549755813776 bytes), down from 512.00GiB (549755813936 bytes) originally
2024-03-17 17:19:12.919552: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -98.99GiB (-106285077306 bytes) by rematerialization; only reduced to 512.00GiB (549755813776 bytes), down from 512.00GiB (549755813936 bytes) originally
2024-03-17 17:19:12.920878: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -98.99GiB (-106285077306 bytes) by rematerialization; only reduced to 512.00GiB (549755813776 bytes), down from 512.00GiB (549755813936 bytes) originally
2024-03-17 17:19:12.921008: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below -98.99GiB (-106285077306 bytes) by rematerialization; only reduced to 512.00GiB (549755813776 bytes), down from 512.00GiB (549755813936 bytes) originally
2024-03-17 17:19:23.003387: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_2_bfc) ran out of memory trying to allocate 128.00GiB (rounded to 137438953472)requested by op 
2024-03-17 17:19:23.003498: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
E0317 17:19:23.003632 3201317 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: f32[512,8192,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


2024-03-17 17:19:23.008423: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_3_bfc) ran out of memory trying to allocate 128.00GiB (rounded to 137438953472)requested by op 
2024-03-17 17:19:23.008635: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
E0317 17:19:23.008872 2447994 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: f32[512,8192,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
2024-03-17 17:19:23.008944: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_2_bfc) ran out of memory trying to allocate 128.00GiB (rounded to 137438953472)requested by op 
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


2024-03-17 17:19:23.009138: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
E0317 17:19:23.009388 2447993 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: f32[512,8192,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
2024-03-17 17:19:23.009649: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_1_bfc) ran out of memory trying to allocate 128.00GiB (rounded to 137438953472)requested by op 
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
2024-03-17 17:19:23.009753: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


E0317 17:19:23.009882 3652463 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: f32[512,8192,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py", line 107, in <module>
    run_benchmark(global_shape,nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py", line 22, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: f32[512,8192,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
2024-03-17 17:19:23.014356: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_0_bfc) ran out of memory trying to allocate 128.00GiB (rounded to 137438953472)requested by op 
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
2024-03-17 17:19:23.014450: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_1_bfc) ran out of memory trying to allocate 128.00GiB (rounded to 137438953472)requested by op 
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
2024-03-17 17:19:23.014569: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
2024-03-17 17:19:23.014650: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


E0317 17:19:23.014799 2447991 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: f32[512,8192,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


E0317 17:19:23.014884 2447992 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: f32[512,8192,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py", line 107, in <module>
    run_benchmark(global_shape,nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py", line 22, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: f32[512,8192,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


2024-03-17 17:19:23.024786: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_3_bfc) ran out of memory trying to allocate 128.00GiB (rounded to 137438953472)requested by op 
2024-03-17 17:19:23.024980: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
E0317 17:19:23.025182 3201318 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: f32[512,8192,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py", line 107, in <module>
    run_benchmark(global_shape,nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py", line 22, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: f32[512,8192,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


2024-03-17 17:19:23.027961: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_0_bfc) ran out of memory trying to allocate 128.00GiB (rounded to 137438953472)requested by op 
2024-03-17 17:19:23.028049: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
E0317 17:19:23.028168 3652462 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: f32[512,8192,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py", line 107, in <module>
    run_benchmark(global_shape,nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py", line 22, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: f32[512,8192,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


2024-03-17 17:19:23.032261: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_1_bfc) ran out of memory trying to allocate 128.00GiB (rounded to 137438953472)requested by op 
2024-03-17 17:19:23.032482: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
2024-03-17 17:19:23.032580: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_0_bfc) ran out of memory trying to allocate 128.00GiB (rounded to 137438953472)requested by op 
E0317 17:19:23.032702 3201316 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: f32[512,8192,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
2024-03-17 17:19:23.032788: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


E0317 17:19:23.032934 3201315 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: f32[512,8192,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py", line 107, in <module>
    run_benchmark(global_shape,nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py", line 22, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: f32[512,8192,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py", line 107, in <module>
    run_benchmark(global_shape,nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py", line 22, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: f32[512,8192,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
2024-03-17 17:19:23.034678: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_3_bfc) ran out of memory trying to allocate 128.00GiB (rounded to 137438953472)requested by op 
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
2024-03-17 17:19:23.034783: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
E0317 17:19:23.034915 3652465 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: f32[512,8192,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


2024-03-17 17:19:23.035094: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_2_bfc) ran out of memory trying to allocate 128.00GiB (rounded to 137438953472)requested by op 
2024-03-17 17:19:23.035222: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
E0317 17:19:23.035385 3652464 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: f32[512,8192,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py", line 107, in <module>
    run_benchmark(global_shape,nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py", line 22, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: f32[512,8192,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
2024-03-17 17:19:23.038144: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_3_bfc) ran out of memory trying to allocate 128.00GiB (rounded to 137438953472)requested by op 
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
2024-03-17 17:19:23.038359: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


E0317 17:19:23.038601 1743311 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: f32[512,8192,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py", line 107, in <module>
    run_benchmark(global_shape,nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py", line 22, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: f32[512,8192,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
2024-03-17 17:19:23.041985: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_0_bfc) ran out of memory trying to allocate 128.00GiB (rounded to 137438953472)requested by op 
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
2024-03-17 17:19:23.042198: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


E0317 17:19:23.042412 1743308 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: f32[512,8192,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py", line 107, in <module>
    run_benchmark(global_shape,nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py", line 22, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: f32[512,8192,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py", line 107, in <module>
    run_benchmark(global_shape,nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py", line 22, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: f32[512,8192,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py", line 107, in <module>
    run_benchmark(global_shape,nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py", line 22, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: f32[512,8192,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py", line 107, in <module>
    run_benchmark(global_shape,nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py", line 22, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: f32[512,8192,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py", line 107, in <module>
    run_benchmark(global_shape,nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py", line 22, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: f32[512,8192,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py", line 107, in <module>
    run_benchmark(global_shape,nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py", line 22, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: f32[512,8192,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


2024-03-17 17:19:23.099833: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_2_bfc) ran out of memory trying to allocate 128.00GiB (rounded to 137438953472)requested by op 
2024-03-17 17:19:23.100037: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
E0317 17:19:23.100175 1743310 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: f32[512,8192,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


2024-03-17 17:19:23.100460: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_1_bfc) ran out of memory trying to allocate 128.00GiB (rounded to 137438953472)requested by op 
2024-03-17 17:19:23.100677: W external/tsl/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
E0317 17:19:23.100887 1743309 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: f32[512,8192,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py", line 107, in <module>
    run_benchmark(global_shape,nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py", line 22, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: f32[512,8192,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py", line 107, in <module>
    run_benchmark(global_shape,nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py", line 22, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 137438953472 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:  128.00GiB
     preallocated temp allocation:  320.00GiB
  preallocated temp fragmentation:       112B (0.00%)
                 total allocation:  448.00GiB
              total fragmentation:   64.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 128.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: f32[512,8192,8192]
		==========================

	Buffer 2:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 3:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[8,2147483648]
		==========================

	Buffer 4:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 5:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 6:
		Size: 64.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: u32[8,2147483648]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: u32[4]
		==========================

	Buffer 9:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[9], u32[9])
		==========================

	Buffer 10:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 11:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[8,2147483648], u32[8,2147483648])
		==========================

	Buffer 12:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[4], u32[4])
		==========================

	Buffer 13:
		Size: 16B
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 14:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: fusion
		Shape: (u32[4], u32[4])
		==========================

	Buffer 15:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/jit(_threefry_split)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/jaxfft.py" source_line=22
		XLA Label: custom-call
		Shape: (u32[9], u32[9])
		==========================


srun: error: r7i5n3: tasks 12-14: Exited with exit code 1
srun: Terminating StepId=1125360.5
slurmstepd: error: *** STEP 1125360.5 ON r6i6n0 CANCELLED AT 2024-03-17T17:19:23 ***
srun: error: r6i6n8: tasks 4-6: Exited with exit code 1
srun: error: r7i5n3: task 15: Exited with exit code 1
srun: error: r6i6n0: tasks 0-3: Exited with exit code 1
srun: error: r7i2n6: tasks 8-11: Exited with exit code 1
srun: error: r6i6n8: task 7: Exited with exit code 1
