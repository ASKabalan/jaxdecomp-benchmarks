2024-03-19 02:35:14.971362: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below 15.01GiB (16121490629 bytes) by rematerialization; only reduced to 32.00GiB (34359738352 bytes), down from 32.00GiB (34359738384 bytes) originally
2024-03-19 02:35:14.971419: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below 15.01GiB (16121490629 bytes) by rematerialization; only reduced to 32.00GiB (34359738352 bytes), down from 32.00GiB (34359738384 bytes) originally
2024-03-19 02:35:14.999542: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below 15.01GiB (16121490629 bytes) by rematerialization; only reduced to 32.00GiB (34359738352 bytes), down from 32.00GiB (34359738384 bytes) originally
2024-03-19 02:35:15.004732: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below 15.01GiB (16121490629 bytes) by rematerialization; only reduced to 32.00GiB (34359738352 bytes), down from 32.00GiB (34359738384 bytes) originally
2024-03-19 02:35:15.009886: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below 15.01GiB (16121490629 bytes) by rematerialization; only reduced to 32.00GiB (34359738352 bytes), down from 32.00GiB (34359738384 bytes) originally
2024-03-19 02:35:15.010468: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below 15.01GiB (16121490629 bytes) by rematerialization; only reduced to 32.00GiB (34359738352 bytes), down from 32.00GiB (34359738384 bytes) originally
2024-03-19 02:35:15.010566: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below 15.01GiB (16121490629 bytes) by rematerialization; only reduced to 32.00GiB (34359738352 bytes), down from 32.00GiB (34359738384 bytes) originally
2024-03-19 02:35:15.008462: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below 15.01GiB (16121490629 bytes) by rematerialization; only reduced to 32.00GiB (34359738352 bytes), down from 32.00GiB (34359738384 bytes) originally
2024-03-19 02:35:14.972360: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below 15.01GiB (16121490629 bytes) by rematerialization; only reduced to 32.00GiB (34359738352 bytes), down from 32.00GiB (34359738384 bytes) originally
2024-03-19 02:35:15.010021: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below 15.01GiB (16121490629 bytes) by rematerialization; only reduced to 32.00GiB (34359738352 bytes), down from 32.00GiB (34359738384 bytes) originally
2024-03-19 02:35:15.008624: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below 15.01GiB (16121490629 bytes) by rematerialization; only reduced to 32.00GiB (34359738352 bytes), down from 32.00GiB (34359738384 bytes) originally
2024-03-19 02:35:15.010644: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below 15.01GiB (16121490629 bytes) by rematerialization; only reduced to 32.00GiB (34359738352 bytes), down from 32.00GiB (34359738384 bytes) originally
2024-03-19 02:35:15.009324: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below 15.01GiB (16121490629 bytes) by rematerialization; only reduced to 32.00GiB (34359738352 bytes), down from 32.00GiB (34359738384 bytes) originally
2024-03-19 02:35:15.036375: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below 15.01GiB (16121490629 bytes) by rematerialization; only reduced to 32.00GiB (34359738352 bytes), down from 32.00GiB (34359738384 bytes) originally
2024-03-19 02:35:14.999783: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below 15.01GiB (16121490629 bytes) by rematerialization; only reduced to 32.00GiB (34359738352 bytes), down from 32.00GiB (34359738384 bytes) originally
2024-03-19 02:35:15.002554: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below 15.01GiB (16121490629 bytes) by rematerialization; only reduced to 32.00GiB (34359738352 bytes), down from 32.00GiB (34359738384 bytes) originally
2024-03-19 02:35:15.002629: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below 15.01GiB (16121490629 bytes) by rematerialization; only reduced to 32.00GiB (34359738352 bytes), down from 32.00GiB (34359738384 bytes) originally
2024-03-19 02:35:15.006805: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below 15.01GiB (16121490629 bytes) by rematerialization; only reduced to 32.00GiB (34359738352 bytes), down from 32.00GiB (34359738384 bytes) originally
2024-03-19 02:35:15.010138: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below 15.01GiB (16121490629 bytes) by rematerialization; only reduced to 32.00GiB (34359738352 bytes), down from 32.00GiB (34359738384 bytes) originally
2024-03-19 02:35:15.011748: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below 15.01GiB (16121490629 bytes) by rematerialization; only reduced to 32.00GiB (34359738352 bytes), down from 32.00GiB (34359738384 bytes) originally
2024-03-19 02:35:15.011894: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below 15.01GiB (16121490629 bytes) by rematerialization; only reduced to 32.00GiB (34359738352 bytes), down from 32.00GiB (34359738384 bytes) originally
2024-03-19 02:35:15.010882: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below 15.01GiB (16121490629 bytes) by rematerialization; only reduced to 32.00GiB (34359738352 bytes), down from 32.00GiB (34359738384 bytes) originally
2024-03-19 02:35:15.010812: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below 15.01GiB (16121490629 bytes) by rematerialization; only reduced to 32.00GiB (34359738352 bytes), down from 32.00GiB (34359738384 bytes) originally
2024-03-19 02:35:15.010888: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below 15.01GiB (16121490629 bytes) by rematerialization; only reduced to 32.00GiB (34359738352 bytes), down from 32.00GiB (34359738384 bytes) originally
2024-03-19 02:35:15.011506: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below 15.01GiB (16121490629 bytes) by rematerialization; only reduced to 32.00GiB (34359738352 bytes), down from 32.00GiB (34359738384 bytes) originally
2024-03-19 02:35:15.011975: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below 15.01GiB (16121490629 bytes) by rematerialization; only reduced to 32.00GiB (34359738352 bytes), down from 32.00GiB (34359738384 bytes) originally
2024-03-19 02:35:15.011685: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below 15.01GiB (16121490629 bytes) by rematerialization; only reduced to 32.00GiB (34359738352 bytes), down from 32.00GiB (34359738384 bytes) originally
2024-03-19 02:35:15.056787: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below 15.01GiB (16121490629 bytes) by rematerialization; only reduced to 32.00GiB (34359738352 bytes), down from 32.00GiB (34359738384 bytes) originally
2024-03-19 02:35:15.057243: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below 15.01GiB (16121490629 bytes) by rematerialization; only reduced to 32.00GiB (34359738352 bytes), down from 32.00GiB (34359738384 bytes) originally
2024-03-19 02:35:15.036379: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below 15.01GiB (16121490629 bytes) by rematerialization; only reduced to 32.00GiB (34359738352 bytes), down from 32.00GiB (34359738384 bytes) originally
2024-03-19 02:35:15.036643: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below 15.01GiB (16121490629 bytes) by rematerialization; only reduced to 32.00GiB (34359738352 bytes), down from 32.00GiB (34359738384 bytes) originally
2024-03-19 02:35:15.038163: W external/xla/xla/service/hlo_rematerialization.cc:2941] Can't reduce memory use below 15.01GiB (16121490629 bytes) by rematerialization; only reduced to 32.00GiB (34359738352 bytes), down from 32.00GiB (34359738384 bytes) originally
2024-03-19 02:35:25.071663: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_0_bfc) ran out of memory trying to allocate 20.00GiB (rounded to 21474836736)requested by op 
2024-03-19 02:35:25.071805: W external/tsl/tsl/framework/bfc_allocator.cc:494] **********************************__________________________________________________________________
E0319 02:35:25.071919 1899349 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


2024-03-19 02:35:25.074863: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_2_bfc) ran out of memory trying to allocate 20.00GiB (rounded to 21474836736)requested by op 
2024-03-19 02:35:25.075087: W external/tsl/tsl/framework/bfc_allocator.cc:494] **********************************__________________________________________________________________
E0319 02:35:25.075211 1899351 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


2024-03-19 02:35:25.077920: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_2_bfc) ran out of memory trying to allocate 20.00GiB (rounded to 21474836736)requested by op 
2024-03-19 02:35:25.078145: W external/tsl/tsl/framework/bfc_allocator.cc:494] **********************************__________________________________________________________________
E0319 02:35:25.078311  436031 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


2024-03-19 02:35:25.100195: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_3_bfc) ran out of memory trying to allocate 20.00GiB (rounded to 21474836736)requested by op 
2024-03-19 02:35:25.100349: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_2_bfc) ran out of memory trying to allocate 20.00GiB (rounded to 21474836736)requested by op 
2024-03-19 02:35:25.100463: W external/tsl/tsl/framework/bfc_allocator.cc:494] **********************************__________________________________________________________________
2024-03-19 02:35:25.100520: W external/tsl/tsl/framework/bfc_allocator.cc:494] **********************************__________________________________________________________________
E0319 02:35:25.100562 2494096 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


2024-03-19 02:35:25.100571: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_0_bfc) ran out of memory trying to allocate 20.00GiB (rounded to 21474836736)requested by op 
E0319 02:35:25.100612 2494095 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


2024-03-19 02:35:25.100673: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_1_bfc) ran out of memory trying to allocate 20.00GiB (rounded to 21474836736)requested by op 
2024-03-19 02:35:25.100776: W external/tsl/tsl/framework/bfc_allocator.cc:494] **********************************__________________________________________________________________
E0319 02:35:25.100929 2494093 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


2024-03-19 02:35:25.100878: W external/tsl/tsl/framework/bfc_allocator.cc:494] **********************************__________________________________________________________________
E0319 02:35:25.101040 2494094 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


2024-03-19 02:35:25.103927: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_2_bfc) ran out of memory trying to allocate 20.00GiB (rounded to 21474836736)requested by op 
2024-03-19 02:35:25.103937: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_3_bfc) ran out of memory trying to allocate 20.00GiB (rounded to 21474836736)requested by op 
2024-03-19 02:35:25.104042: W external/tsl/tsl/framework/bfc_allocator.cc:494] **********************************__________________________________________________________________
2024-03-19 02:35:25.104043: W external/tsl/tsl/framework/bfc_allocator.cc:494] **********************************__________________________________________________________________
E0319 02:35:25.104126 1815692 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


E0319 02:35:25.104127 1815691 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


2024-03-19 02:35:25.117433: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_1_bfc) ran out of memory trying to allocate 20.00GiB (rounded to 21474836736)requested by op 
2024-03-19 02:35:25.117656: W external/tsl/tsl/framework/bfc_allocator.cc:494] **********************************__________________________________________________________________
E0319 02:35:25.117849 3628256 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
2024-03-19 02:35:25.118169: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_0_bfc) ran out of memory trying to allocate 20.00GiB (rounded to 21474836736)requested by op 
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


2024-03-19 02:35:25.118270: W external/tsl/tsl/framework/bfc_allocator.cc:494] **********************************__________________________________________________________________
jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
E0319 02:35:25.118360 3628255 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


2024-03-19 02:35:25.118733: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_3_bfc) ran out of memory trying to allocate 20.00GiB (rounded to 21474836736)requested by op 
2024-03-19 02:35:25.118852: W external/tsl/tsl/framework/bfc_allocator.cc:494] **********************************__________________________________________________________________
E0319 02:35:25.118928 3628258 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


2024-03-19 02:35:25.119919: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_1_bfc) ran out of memory trying to allocate 20.00GiB (rounded to 21474836736)requested by op 
2024-03-19 02:35:25.120134: W external/tsl/tsl/framework/bfc_allocator.cc:494] **********************************__________________________________________________________________
E0319 02:35:25.120221 1899350 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


2024-03-19 02:35:25.120660: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_2_bfc) ran out of memory trying to allocate 20.00GiB (rounded to 21474836736)requested by op 
2024-03-19 02:35:25.120825: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_3_bfc) ran out of memory trying to allocate 20.00GiB (rounded to 21474836736)requested by op 
2024-03-19 02:35:25.120762: W external/tsl/tsl/framework/bfc_allocator.cc:494] **********************************__________________________________________________________________
2024-03-19 02:35:25.121039: W external/tsl/tsl/framework/bfc_allocator.cc:494] **********************************__________________________________________________________________
E0319 02:35:25.120853 3628257 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
E0319 02:35:25.121187 1899352 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


2024-03-19 02:35:25.123144: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_0_bfc) ran out of memory trying to allocate 20.00GiB (rounded to 21474836736)requested by op 
2024-03-19 02:35:25.123254: W external/tsl/tsl/framework/bfc_allocator.cc:494] **********************************__________________________________________________________________
E0319 02:35:25.123363  436029 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


2024-03-19 02:35:25.124418: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_1_bfc) ran out of memory trying to allocate 20.00GiB (rounded to 21474836736)requested by op 
2024-03-19 02:35:25.124516: W external/tsl/tsl/framework/bfc_allocator.cc:494] **********************************__________________________________________________________________
E0319 02:35:25.124597  436030 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


2024-03-19 02:35:25.126467: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_3_bfc) ran out of memory trying to allocate 20.00GiB (rounded to 21474836736)requested by op 
2024-03-19 02:35:25.126619: W external/tsl/tsl/framework/bfc_allocator.cc:494] **********************************__________________________________________________________________
E0319 02:35:25.126696  436032 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


2024-03-19 02:35:25.127561: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_0_bfc) ran out of memory trying to allocate 20.00GiB (rounded to 21474836736)requested by op 
2024-03-19 02:35:25.127580: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_1_bfc) ran out of memory trying to allocate 20.00GiB (rounded to 21474836736)requested by op 
2024-03-19 02:35:25.127784: W external/tsl/tsl/framework/bfc_allocator.cc:494] **********************************__________________________________________________________________
2024-03-19 02:35:25.127789: W external/tsl/tsl/framework/bfc_allocator.cc:494] **********************************__________________________________________________________________
E0319 02:35:25.127942 1469640 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


E0319 02:35:25.127946 1469641 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


2024-03-19 02:35:25.128913: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_3_bfc) ran out of memory trying to allocate 20.00GiB (rounded to 21474836736)requested by op 
2024-03-19 02:35:25.129155: W external/tsl/tsl/framework/bfc_allocator.cc:494] **********************************__________________________________________________________________
2024-03-19 02:35:25.129183: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_2_bfc) ran out of memory trying to allocate 20.00GiB (rounded to 21474836736)requested by op 
E0319 02:35:25.129310 1469643 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


2024-03-19 02:35:25.129389: W external/tsl/tsl/framework/bfc_allocator.cc:494] **********************************__________________________________________________________________
E0319 02:35:25.129531 1469642 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
2024-03-19 02:35:25.130046: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_1_bfc) ran out of memory trying to allocate 20.00GiB (rounded to 21474836736)requested by op 
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
2024-03-19 02:35:25.130243: W external/tsl/tsl/framework/bfc_allocator.cc:494] **********************************__________________________________________________________________
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
E0319 02:35:25.130341  221382 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


2024-03-19 02:35:25.130388: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_0_bfc) ran out of memory trying to allocate 20.00GiB (rounded to 21474836736)requested by op 
2024-03-19 02:35:25.130484: W external/tsl/tsl/framework/bfc_allocator.cc:494] **********************************__________________________________________________________________
E0319 02:35:25.130568  221381 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


2024-03-19 02:35:25.131083: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_2_bfc) ran out of memory trying to allocate 20.00GiB (rounded to 21474836736)requested by op 
2024-03-19 02:35:25.131194: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_3_bfc) ran out of memory trying to allocate 20.00GiB (rounded to 21474836736)requested by op 
2024-03-19 02:35:25.131303: W external/tsl/tsl/framework/bfc_allocator.cc:494] **********************************__________________________________________________________________
2024-03-19 02:35:25.131359: W external/tsl/tsl/framework/bfc_allocator.cc:494] **********************************__________________________________________________________________
E0319 02:35:25.131419  221383 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


E0319 02:35:25.131460  221384 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
2024-03-19 02:35:25.141346: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_0_bfc) ran out of memory trying to allocate 20.00GiB (rounded to 21474836736)requested by op 
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


2024-03-19 02:35:25.141568: W external/tsl/tsl/framework/bfc_allocator.cc:494] **********************************__________________________________________________________________
E0319 02:35:25.141734 3010701 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


2024-03-19 02:35:25.141901: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_3_bfc) ran out of memory trying to allocate 20.00GiB (rounded to 21474836736)requested by op 
2024-03-19 02:35:25.142122: W external/tsl/tsl/framework/bfc_allocator.cc:494] **********************************__________________________________________________________________
E0319 02:35:25.142304 3010704 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


2024-03-19 02:35:25.155964: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_0_bfc) ran out of memory trying to allocate 20.00GiB (rounded to 21474836736)requested by op 
2024-03-19 02:35:25.156187: W external/tsl/tsl/framework/bfc_allocator.cc:494] **********************************__________________________________________________________________
2024-03-19 02:35:25.156233: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_1_bfc) ran out of memory trying to allocate 20.00GiB (rounded to 21474836736)requested by op 
E0319 02:35:25.156349 1815689 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


2024-03-19 02:35:25.156450: W external/tsl/tsl/framework/bfc_allocator.cc:494] **********************************__________________________________________________________________
E0319 02:35:25.156585 1815690 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


2024-03-19 02:35:25.196154: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_1_bfc) ran out of memory trying to allocate 20.00GiB (rounded to 21474836736)requested by op 
2024-03-19 02:35:25.196380: W external/tsl/tsl/framework/bfc_allocator.cc:494] **********************************__________________________________________________________________
E0319 02:35:25.196542 3010702 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


2024-03-19 02:35:25.197226: W external/tsl/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_2_bfc) ran out of memory trying to allocate 20.00GiB (rounded to 21474836736)requested by op 
2024-03-19 02:35:25.197431: W external/tsl/tsl/framework/bfc_allocator.cc:494] **********************************__________________________________________________________________
E0319 02:35:25.197571 3010703 pjrt_stream_executor_client.cc:2804] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 170, in <module>
    run_benchmark(pdims, global_shape, backend, nb_nodes, output_path)
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py", line 34, in run_benchmark
    array = jax.random.normal(
  File "/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/venv/v100/lib/python3.10/site-packages/jax/_src/random.py", line 720, in normal
    return _normal(key, shape, dtype)  # type: ignore
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 21474836736 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:         0B
        maybe_live_out allocation:    8.00GiB
     preallocated temp allocation:   20.00GiB
  preallocated temp fragmentation:         0B (0.00%)
                 total allocation:   28.00GiB
              total fragmentation:    4.00GiB (14.29%)
Peak buffers:
	Buffer 1:
		Size: 8.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/mul" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: f32[256,2048,4096]
		==========================

	Buffer 2:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 3:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: u32[1073741824]
		==========================

	Buffer 4:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(1073741824,) limit_indices=(2147483648,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 5:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/slice[start_indices=(0,) limit_indices=(1073741824,) strides=None]" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 6:
		Size: 4.00GiB
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: u32[1073741824]
		==========================

	Buffer 7:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: fusion
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 8:
		Size: 16B
		Operator: op_name="jit(_normal)/jit(main)/jit(_normal_real)/jit(_uniform)/threefry2x32" source_file="/gpfsdswork/projects/rech/tkc/commun/jaxDecomp/benchmarks/pfft3d.py" source_line=34
		XLA Label: custom-call
		Shape: (u32[1073741824], u32[1073741824])
		==========================

	Buffer 9:
		Size: 8B
		Entry Parameter Subshape: u32[2]
		==========================


srun: error: r6i6n5: tasks 8-10: Exited with exit code 1
srun: Terminating StepId=1139806.27
slurmstepd: error: *** STEP 1139806.27 ON r6i6n3 CANCELLED AT 2024-03-19T02:35:25 ***
srun: error: r8i7n0: tasks 25-27: Exited with exit code 1
srun: error: r8i6n7: tasks 16-17,19: Exited with exit code 1
srun: error: r8i7n1: tasks 28,30-31: Exited with exit code 1
srun: error: r8i6n6: tasks 12-15: Exited with exit code 1
srun: error: r6i6n3: tasks 0-3: Exited with exit code 1
srun: error: r8i6n7: task 18: Exited with exit code 1
srun: error: r8i7n1: task 29: Exited with exit code 1
srun: error: r6i6n4: tasks 4-7: Exited with exit code 1
srun: error: r8i7n0: task 24: Exited with exit code 1
srun: error: r8i6n8: tasks 20-23: Exited with exit code 1
srun: error: r6i6n5: task 11: Exited with exit code 1
